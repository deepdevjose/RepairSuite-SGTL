(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,48363,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22623),l=e.i(91432),r=e.i(36073),o=e.i(70065),i=e.i(67881),n=e.i(23750),c=e.i(10708),d=e.i(25959),m=e.i(84762),x=e.i(62870),u=e.i(20682),h=e.i(64659),p=e.i(55900),v=e.i(63209),g=e.i(95468),b=e.i(75254);let f=(0,b.default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),j=[{telefono:"5512345678",correo:"juan.perez@email.com",nombre:"Juan Pérez García"},{telefono:"5587654321",correo:"maria.gonzalez@email.com",nombre:"María González López"}];function N({onClose:e,onSave:a,initialData:l}){let{toast:r}=(0,u.useToast)(),[o,b]=(0,t.useState)({nombre1:l?.nombre1||"",middle_name:l?.middle_name||"",apellido_paterno:l?.apellido_paterno||"",apellido_materno:l?.apellido_materno||"",telefono:l?.telefono||"",correo:l?.correo||"",sexo:l?.sexo||"",edad:l?.edad||"",calle:l?.calle||"",numero:l?.numero||"",colonia:l?.colonia||"",municipio:l?.municipio||"",estado:l?.estado||"",pais:l?.pais||"México",rfc:l?.rfc||"",tipo_cliente:l?.tipo_cliente||"",notas_internas:l?.notas_internas||"",activo:l?.activo??!0}),[N,C]=(0,t.useState)({}),[w,y]=(0,t.useState)({personal:!0,direccion:!0,otros:!0}),[_,k]=(0,t.useState)("");return(0,t.useEffect)(()=>{o.rfc&&o.rfc.length>0&&(/^([A-ZÑ&]{3,4})?(\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01]))?([A-Z\d]{2}[A\d])?$/.test(o.rfc.toUpperCase())?C(e=>{let s={...e};return delete s.rfc,s}):C(e=>({...e,rfc:"Formato de RFC inválido"})))},[o.rfc]),(0,t.useEffect)(()=>{if(o.telefono.length>=10||o.correo.includes("@")){let e=j.find(e=>e.telefono===o.telefono||e.correo===o.correo);e?k(`Posible duplicado: ${e.nombre}`):k("")}},[o.telefono,o.correo]),(0,s.jsxs)("form",{onSubmit:s=>{let t;s.preventDefault(),(t={},o.nombre1.trim()||(t.nombre1="El nombre es obligatorio"),o.apellido_paterno.trim()||(t.apellido_paterno="El apellido paterno es obligatorio"),o.telefono.trim()?/^\d{10}$/.test(o.telefono.replace(/\D/g,""))||(t.telefono="El teléfono debe tener 10 dígitos"):t.telefono="El teléfono es obligatorio",o.correo&&!/\S+@\S+\.\S+/.test(o.correo)&&(t.correo="El formato del correo no es válido"),o.edad&&(isNaN(Number(o.edad))||0>Number(o.edad))&&(t.edad="La edad debe ser un número válido"),C(t),0!==Object.keys(t).length)?r({title:"Error de validación",description:"Por favor, corrige los errores antes de continuar.",variant:"destructive"}):(a&&a(o),r({title:"Cliente guardado",description:"Los datos del cliente se han guardado correctamente."}),e())},className:"space-y-6",children:[_&&(0,s.jsxs)("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30 flex items-start gap-3 animate-fade-in",children:[(0,s.jsx)(v.AlertCircle,{className:"h-5 w-5 text-amber-400 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-amber-200",children:"Cliente potencialmente duplicado"}),(0,s.jsx)("p",{className:"text-xs text-amber-300/80 mt-0.5",children:_})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border border-slate-800/50 rounded-lg p-4 bg-slate-900/30",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>y({...w,personal:!w.personal}),className:"flex items-center justify-between w-full text-left group",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100 group-hover:text-violet-400 transition-colors",children:"Información personal"}),w.personal?(0,s.jsx)(p.ChevronUp,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"}):(0,s.jsx)(h.ChevronDown,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"})]}),w.personal&&(0,s.jsxs)("div",{className:"space-y-4 pt-2 animate-fade-in",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"nombre1",className:"text-slate-200 flex items-center gap-1.5",children:["Nombre ",(0,s.jsx)("span",{className:"text-red-400",children:"*"}),o.nombre1&&!N.nombre1&&(0,s.jsx)(g.CheckCircle2,{className:"h-3.5 w-3.5 text-emerald-400"})]}),(0,s.jsx)(n.Input,{id:"nombre1",value:o.nombre1,onChange:e=>b({...o,nombre1:e.target.value}),className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.nombre1?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`}),N.nombre1&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.nombre1]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"middle_name",className:"text-slate-200",children:"Segundo nombre"}),(0,s.jsx)(n.Input,{id:"middle_name",value:o.middle_name,onChange:e=>b({...o,middle_name:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"apellido_paterno",className:"text-slate-200 flex items-center gap-1.5",children:["Apellido paterno ",(0,s.jsx)("span",{className:"text-red-400",children:"*"}),o.apellido_paterno&&!N.apellido_paterno&&(0,s.jsx)(g.CheckCircle2,{className:"h-3.5 w-3.5 text-emerald-400"})]}),(0,s.jsx)(n.Input,{id:"apellido_paterno",value:o.apellido_paterno,onChange:e=>b({...o,apellido_paterno:e.target.value}),className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.apellido_paterno?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`}),N.apellido_paterno&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.apellido_paterno]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"apellido_materno",className:"text-slate-200",children:"Apellido materno"}),(0,s.jsx)(n.Input,{id:"apellido_materno",value:o.apellido_materno,onChange:e=>b({...o,apellido_materno:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"telefono",className:"text-slate-200 flex items-center gap-1.5",children:["Teléfono ",(0,s.jsx)("span",{className:"text-red-400",children:"*"}),10===o.telefono.length&&!N.telefono&&(0,s.jsx)(g.CheckCircle2,{className:"h-3.5 w-3.5 text-emerald-400"})]}),(0,s.jsx)(n.Input,{id:"telefono",value:o.telefono,onChange:e=>{let s;return b({...o,telefono:(s=e.target.value.replace(/\D/g,"")).length<=10?s:s.slice(0,10)})},placeholder:"5512345678",maxLength:10,className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.telefono?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`}),N.telefono&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.telefono]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"correo",className:"text-slate-200 flex items-center gap-1.5",children:["Correo electrónico",o.correo&&!N.correo&&(0,s.jsx)(g.CheckCircle2,{className:"h-3.5 w-3.5 text-emerald-400"})]}),(0,s.jsx)(n.Input,{id:"correo",type:"email",value:o.correo,onChange:e=>b({...o,correo:e.target.value}),className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.correo?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`}),N.correo&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.correo]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"rfc",className:"text-slate-200 flex items-center gap-1.5",children:["RFC",o.rfc&&!N.rfc&&(0,s.jsx)(g.CheckCircle2,{className:"h-3.5 w-3.5 text-emerald-400"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(n.Input,{id:"rfc",value:o.rfc,onChange:e=>b({...o,rfc:e.target.value.toUpperCase()}),className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.rfc?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`,placeholder:"XAXX010101000"}),(0,s.jsx)(i.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{b({...o,rfc:"XAXX010101000"}),r({title:"RFC genérico aplicado",description:"Se ha asignado el RFC genérico para público en general."})},className:"border-slate-700/50 text-slate-400 hover:text-slate-200 hover:bg-slate-800 shrink-0",children:"Genérico"})]}),N.rfc&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.rfc]})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"sexo",className:"text-slate-200",children:"Sexo"}),(0,s.jsxs)(x.Select,{value:o.sexo,onValueChange:e=>b({...o,sexo:e}),children:[(0,s.jsx)(x.SelectTrigger,{className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20",children:(0,s.jsx)(x.SelectValue,{placeholder:"Seleccionar"})}),(0,s.jsxs)(x.SelectContent,{className:"bg-slate-800 border-slate-700",children:[(0,s.jsx)(x.SelectItem,{value:"M",children:"Masculino"}),(0,s.jsx)(x.SelectItem,{value:"F",children:"Femenino"}),(0,s.jsx)(x.SelectItem,{value:"O",children:"Otro"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"edad",className:"text-slate-200",children:"Edad"}),(0,s.jsx)(n.Input,{id:"edad",type:"number",value:o.edad,onChange:e=>b({...o,edad:e.target.value}),className:`bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all ${N.edad?"border-red-500/50 focus:border-red-500 focus:ring-red-500/20":""}`}),N.edad&&(0,s.jsxs)("p",{className:"text-xs text-red-400 flex items-center gap-1",children:[(0,s.jsx)(v.AlertCircle,{className:"h-3 w-3"}),N.edad]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"tipo_cliente",className:"text-slate-200",children:"Tipo de cliente"}),(0,s.jsxs)(x.Select,{value:o.tipo_cliente,onValueChange:e=>b({...o,tipo_cliente:e}),children:[(0,s.jsx)(x.SelectTrigger,{className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20",children:(0,s.jsx)(x.SelectValue,{placeholder:"Seleccionar"})}),(0,s.jsxs)(x.SelectContent,{className:"bg-slate-800 border-slate-700",children:[(0,s.jsx)(x.SelectItem,{value:"publico_general",children:"Público general"}),(0,s.jsx)(x.SelectItem,{value:"empresa",children:"Empresa"}),(0,s.jsx)(x.SelectItem,{value:"recurrente",children:"Recurrente"})]})]})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border border-slate-800/50 rounded-lg p-4 bg-slate-900/30",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>y({...w,direccion:!w.direccion}),className:"flex items-center justify-between w-full text-left group",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100 group-hover:text-violet-400 transition-colors",children:"Dirección"}),w.direccion?(0,s.jsx)(p.ChevronUp,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"}):(0,s.jsx)(h.ChevronDown,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"})]}),w.direccion&&(0,s.jsxs)("div",{className:"space-y-4 pt-2 animate-fade-in",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2 md:col-span-2",children:[(0,s.jsx)(c.Label,{htmlFor:"calle",className:"text-slate-200",children:"Calle"}),(0,s.jsx)(n.Input,{id:"calle",value:o.calle,onChange:e=>b({...o,calle:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"numero",className:"text-slate-200",children:"Número"}),(0,s.jsx)(n.Input,{id:"numero",value:o.numero,onChange:e=>b({...o,numero:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"colonia",className:"text-slate-200",children:"Colonia"}),(0,s.jsx)(n.Input,{id:"colonia",value:o.colonia,onChange:e=>b({...o,colonia:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"municipio",className:"text-slate-200",children:"Municipio"}),(0,s.jsx)(n.Input,{id:"municipio",value:o.municipio,onChange:e=>b({...o,municipio:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"estado",className:"text-slate-200",children:"Estado"}),(0,s.jsx)(n.Input,{id:"estado",value:o.estado,onChange:e=>b({...o,estado:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(c.Label,{htmlFor:"pais",className:"text-slate-200",children:"País"}),(0,s.jsx)(n.Input,{id:"pais",value:o.pais,onChange:e=>b({...o,pais:e.target.value}),className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4 border border-slate-800/50 rounded-lg p-4 bg-slate-900/30",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>y({...w,otros:!w.otros}),className:"flex items-center justify-between w-full text-left group",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-100 group-hover:text-violet-400 transition-colors",children:"Otros datos"}),w.otros?(0,s.jsx)(p.ChevronUp,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"}):(0,s.jsx)(h.ChevronDown,{className:"h-5 w-5 text-slate-400 group-hover:text-violet-400 transition-colors"})]}),w.otros&&(0,s.jsxs)("div",{className:"space-y-4 pt-2 animate-fade-in",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(c.Label,{htmlFor:"notas_internas",className:"text-slate-200 flex items-center gap-1.5",children:["Notas internas",(0,s.jsx)(f,{className:"h-3.5 w-3.5 text-slate-500"})]}),(0,s.jsx)(m.Textarea,{id:"notas_internas",value:o.notas_internas,onChange:e=>b({...o,notas_internas:e.target.value}),placeholder:"Información adicional visible solo para el personal...",rows:4,className:"bg-slate-800/50 border-slate-700/50 text-slate-100 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all resize-none"}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"Solo visible para el personal del taller"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.Checkbox,{id:"activo",checked:o.activo,onCheckedChange:e=>b({...o,activo:!!e})}),(0,s.jsx)(c.Label,{htmlFor:"activo",className:"text-slate-200 cursor-pointer",children:"Cliente activo"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-800/50",children:[(0,s.jsx)(i.Button,{type:"button",variant:"outline",onClick:e,className:"border-slate-700/50 text-slate-300 bg-transparent hover:bg-slate-800/50",children:"Cancelar"}),(0,s.jsx)(i.Button,{type:"submit",className:"bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 shadow-lg shadow-indigo-500/20 transition-all duration-300 hover:shadow-indigo-500/30 hover:scale-[1.02]",children:"Guardar cliente"})]})]})}var C=e.i(47627),w=e.i(30374),y=e.i(81140),_=e.i(20783),k=e.i(30030),S=e.i(26330),P=e.i(3536),A=e.i(65491),F=e.i(10772),z=e.i(53660),L=e.i(74606),T=e.i(96626),D=e.i(48425),R=e.i(91918),q=e.i(69340),I=e.i(86312),M=e.i(85369),E="Popover",[O,B]=(0,k.createContextScope)(E,[z.createPopperScope]),H=(0,z.createPopperScope)(),[X,U]=O(E),$=e=>{let{__scopePopover:a,children:l,open:r,defaultOpen:o,onOpenChange:i,modal:n=!1}=e,c=H(a),d=t.useRef(null),[m,x]=t.useState(!1),[u=!1,h]=(0,q.useControllableState)({prop:r,defaultProp:o,onChange:i});return(0,s.jsx)(z.Root,{...c,children:(0,s.jsx)(X,{scope:a,contentId:(0,F.useId)(),triggerRef:d,open:u,onOpenChange:h,onOpenToggle:t.useCallback(()=>h(e=>!e),[h]),hasCustomAnchor:m,onCustomAnchorAdd:t.useCallback(()=>x(!0),[]),onCustomAnchorRemove:t.useCallback(()=>x(!1),[]),modal:n,children:l})})};$.displayName=E;var G="PopoverAnchor";t.forwardRef((e,a)=>{let{__scopePopover:l,...r}=e,o=U(G,l),i=H(l),{onCustomAnchorAdd:n,onCustomAnchorRemove:c}=o;return t.useEffect(()=>(n(),()=>c()),[n,c]),(0,s.jsx)(z.Anchor,{...i,...r,ref:a})}).displayName=G;var V="PopoverTrigger",K=t.forwardRef((e,t)=>{let{__scopePopover:a,...l}=e,r=U(V,a),o=H(a),i=(0,_.useComposedRefs)(t,r.triggerRef),n=(0,s.jsx)(D.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":er(r.open),...l,ref:i,onClick:(0,y.composeEventHandlers)(e.onClick,r.onOpenToggle)});return r.hasCustomAnchor?n:(0,s.jsx)(z.Anchor,{asChild:!0,...o,children:n})});K.displayName=V;var Z="PopoverPortal",[J,Y]=O(Z,{forceMount:void 0}),Q=e=>{let{__scopePopover:t,forceMount:a,children:l,container:r}=e,o=U(Z,t);return(0,s.jsx)(J,{scope:t,forceMount:a,children:(0,s.jsx)(T.Presence,{present:a||o.open,children:(0,s.jsx)(L.Portal,{asChild:!0,container:r,children:l})})})};Q.displayName=Z;var W="PopoverContent",ee=t.forwardRef((e,t)=>{let a=Y(W,e.__scopePopover),{forceMount:l=a.forceMount,...r}=e,o=U(W,e.__scopePopover);return(0,s.jsx)(T.Presence,{present:l||o.open,children:o.modal?(0,s.jsx)(es,{...r,ref:t}):(0,s.jsx)(et,{...r,ref:t})})});ee.displayName=W;var es=t.forwardRef((e,a)=>{let l=U(W,e.__scopePopover),r=t.useRef(null),o=(0,_.useComposedRefs)(a,r),i=t.useRef(!1);return t.useEffect(()=>{let e=r.current;if(e)return(0,I.hideOthers)(e)},[]),(0,s.jsx)(M.RemoveScroll,{as:R.Slot,allowPinchZoom:!0,children:(0,s.jsx)(ea,{...e,ref:o,trapFocus:l.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,y.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),i.current||l.triggerRef.current?.focus()}),onPointerDownOutside:(0,y.composeEventHandlers)(e.onPointerDownOutside,e=>{let s=e.detail.originalEvent,t=0===s.button&&!0===s.ctrlKey;i.current=2===s.button||t},{checkForDefaultPrevented:!1}),onFocusOutside:(0,y.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault(),{checkForDefaultPrevented:!1})})})}),et=t.forwardRef((e,a)=>{let l=U(W,e.__scopePopover),r=t.useRef(!1),o=t.useRef(!1);return(0,s.jsx)(ea,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{e.onCloseAutoFocus?.(s),s.defaultPrevented||(r.current||l.triggerRef.current?.focus(),s.preventDefault()),r.current=!1,o.current=!1},onInteractOutside:s=>{e.onInteractOutside?.(s),s.defaultPrevented||(r.current=!0,"pointerdown"===s.detail.originalEvent.type&&(o.current=!0));let t=s.target;l.triggerRef.current?.contains(t)&&s.preventDefault(),"focusin"===s.detail.originalEvent.type&&o.current&&s.preventDefault()}})}),ea=t.forwardRef((e,t)=>{let{__scopePopover:a,trapFocus:l,onOpenAutoFocus:r,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:n,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:m,...x}=e,u=U(W,a),h=H(a);return(0,P.useFocusGuards)(),(0,s.jsx)(A.FocusScope,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:r,onUnmountAutoFocus:o,children:(0,s.jsx)(S.DismissableLayer,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:m,onEscapeKeyDown:n,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>u.onOpenChange(!1),children:(0,s.jsx)(z.Content,{"data-state":er(u.open),role:"dialog",id:u.contentId,...h,...x,ref:t,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),el="PopoverClose";function er(e){return e?"open":"closed"}t.forwardRef((e,t)=>{let{__scopePopover:a,...l}=e,r=U(el,a);return(0,s.jsx)(D.Primitive.button,{type:"button",...l,ref:t,onClick:(0,y.composeEventHandlers)(e.onClick,()=>r.onOpenChange(!1))})}).displayName=el,t.forwardRef((e,t)=>{let{__scopePopover:a,...l}=e,r=H(a);return(0,s.jsx)(z.Arrow,{...r,...l,ref:t})}).displayName="PopoverArrow";var eo=e.i(47163);function ei({...e}){return(0,s.jsx)($,{"data-slot":"popover",...e})}function en({...e}){return(0,s.jsx)(K,{"data-slot":"popover-trigger",...e})}function ec({className:e,align:t="center",sideOffset:a=4,...l}){return(0,s.jsx)(Q,{children:(0,s.jsx)(ee,{"data-slot":"popover-content",align:t,sideOffset:a,className:(0,eo.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...l})})}var ed=e.i(55436),em=e.i(7233),ex=e.i(61911);let eu=(0,b.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),eh=(0,b.default)("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);var ep=e.i(91741),ev=e.i(88844),eg=e.i(86536);let eb=[{id:1,nombre:"Juan Pérez García",telefono:"5512345678",correo:"juan.perez@email.com",fecha_registro:"2024-03-15",num_equipos:3,ultimo_servicio:"2024-12-10",ordenes_activas:1,es_recurrente:!0,equipos:[{id:101,marca:"Dell",modelo:"Latitude 5420",serie:"DL2024X001"},{id:102,marca:"HP",modelo:"ProBook 450",serie:"HP2024X002"},{id:103,marca:"Lenovo",modelo:"ThinkPad X1",serie:"LN2024X003"}]},{id:2,nombre:"María González López",telefono:"5587654321",correo:"maria.gonzalez@email.com",fecha_registro:"2024-06-20",num_equipos:1,ultimo_servicio:"2024-11-28",ordenes_activas:0,es_recurrente:!1,equipos:[{id:201,marca:"Asus",modelo:"VivoBook 15",serie:"AS2024X004"}]},{id:3,nombre:"Pedro Ramírez Sánchez",telefono:"5523456789",correo:"pedro.ramirez@email.com",fecha_registro:"2024-08-10",num_equipos:2,ultimo_servicio:"2024-12-05",ordenes_activas:2,es_recurrente:!0,equipos:[{id:301,marca:"Acer",modelo:"Aspire 5",serie:"AC2024X005"},{id:302,marca:"MSI",modelo:"Modern 14",serie:"MS2024X006"}]},{id:4,nombre:"Ana López Martínez",telefono:"5598765432",correo:"ana.lopez@email.com",fecha_registro:"2024-11-05",num_equipos:1,ultimo_servicio:"2024-12-15",ordenes_activas:1,es_recurrente:!1,equipos:[{id:401,marca:"Apple",modelo:"MacBook Air M2",serie:"AP2024X007"}]},{id:5,nombre:"Carlos Hernández Torres",telefono:"5534567890",correo:"carlos.hernandez@email.com",fecha_registro:"2024-12-01",num_equipos:4,ultimo_servicio:null,ordenes_activas:0,es_recurrente:!1,equipos:[{id:501,marca:"Dell",modelo:"XPS 13",serie:"DL2024X008"},{id:502,marca:"HP",modelo:"Pavilion",serie:"HP2024X009"},{id:503,marca:"Lenovo",modelo:"IdeaPad 3",serie:"LN2024X010"},{id:504,marca:"Samsung",modelo:"Galaxy Book",serie:"SM2024X011"}]},{id:6,nombre:"Laura Martínez Ruiz",telefono:"5545678901",correo:"laura.martinez@email.com",fecha_registro:"2024-01-20",num_equipos:2,ultimo_servicio:"2024-06-15",ordenes_activas:0,es_recurrente:!1,equipos:[{id:601,marca:"Asus",modelo:"ROG Strix",serie:"AS2024X012"},{id:602,marca:"Acer",modelo:"Nitro 5",serie:"AC2024X013"}]}];function ef(){let{hasPermission:e}=(0,l.useAuth)(),[c,d]=(0,t.useState)(""),[m,x]=(0,t.useState)(!1),[u,h]=(0,t.useState)("all"),[p,v]=(0,t.useState)(null);if(!e("clientes"))return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.DashboardHeader,{title:"Clientes"}),(0,s.jsx)(r.AccessDenied,{})]});let g=eb.filter(e=>{let s=c.toLowerCase(),t=""===c||e.nombre.toLowerCase().includes(s)||e.telefono.includes(c)||e.correo.toLowerCase().includes(s)||e.equipos.some(e=>e.marca.toLowerCase().includes(s)||e.modelo.toLowerCase().includes(s)||e.serie.toLowerCase().includes(s)),a=new Date;a.setDate(a.getDate()-30);let l=new Date(e.fecha_registro),r="all"===u||"new"===u&&l>=a||"active-orders"===u&&e.ordenes_activas>0||"inactive"===u&&e.ultimo_servicio&&new Date(e.ultimo_servicio)<a||"multi-equipment"===u&&e.num_equipos>1||"recurring"===u&&e.es_recurrente;return t&&r}),b=eb.length,f=eb.filter(e=>{let s=new Date(e.fecha_registro),t=new Date;return s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}).length,j=eb.filter(e=>e.es_recurrente).length,y=eb.filter(e=>e.ordenes_activas>0).length;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.DashboardHeader,{title:"Clientes"}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6 animate-fade-in",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsx)(o.Card,{className:"bg-gradient-to-br from-slate-900 to-slate-900/50 border-slate-800/50 p-4 hover:shadow-lg hover:shadow-violet-500/10 transition-all duration-300",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2.5 rounded-lg bg-violet-500/10 border border-violet-500/20",children:(0,s.jsx)(ex.Users,{className:"h-5 w-5 text-violet-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 font-medium",children:"Total de clientes"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:b})]})]})}),(0,s.jsx)(o.Card,{className:"bg-gradient-to-br from-slate-900 to-slate-900/50 border-slate-800/50 p-4 hover:shadow-lg hover:shadow-emerald-500/10 transition-all duration-300",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2.5 rounded-lg bg-emerald-500/10 border border-emerald-500/20",children:(0,s.jsx)(eu,{className:"h-5 w-5 text-emerald-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 font-medium",children:"Nuevos del mes"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:f})]})]})}),(0,s.jsx)(o.Card,{className:"bg-gradient-to-br from-slate-900 to-slate-900/50 border-slate-800/50 p-4 hover:shadow-lg hover:shadow-blue-500/10 transition-all duration-300",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2.5 rounded-lg bg-blue-500/10 border border-blue-500/20",children:(0,s.jsx)(eh,{className:"h-5 w-5 text-blue-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 font-medium",children:"Clientes recurrentes"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:j})]})]})}),(0,s.jsx)(o.Card,{className:"bg-gradient-to-br from-slate-900 to-slate-900/50 border-slate-800/50 p-4 hover:shadow-lg hover:shadow-amber-500/10 transition-all duration-300",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2.5 rounded-lg bg-amber-500/10 border border-amber-500/20",children:(0,s.jsx)(ep.ClipboardList,{className:"h-5 w-5 text-amber-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-slate-400 font-medium",children:"Con órdenes activas"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:y})]})]})})]}),(0,s.jsx)(o.Card,{className:"bg-slate-900/50 border-slate-800/50 backdrop-blur-sm p-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(ed.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-500"}),(0,s.jsx)(n.Input,{placeholder:"Buscar por nombre, teléfono, correo, equipo o serie...",value:c,onChange:e=>d(e.target.value),className:"pl-10 bg-slate-800/50 border-slate-700/50 text-slate-100 placeholder:text-slate-500 focus:border-violet-500/50 focus:ring-1 focus:ring-violet-500/20 transition-all"})]}),(0,s.jsxs)(i.Button,{onClick:()=>x(!0),className:"bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 shadow-lg shadow-indigo-500/20 transition-all duration-300 hover:shadow-indigo-500/30 hover:scale-[1.02]",children:[(0,s.jsx)(em.Plus,{className:"h-4 w-4 mr-2"}),"Nuevo cliente"]})]})}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(i.Button,{size:"sm",variant:"all"===u?"default":"outline",onClick:()=>h("all"),className:"all"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:["Todos (",eb.length,")"]}),(0,s.jsx)(i.Button,{size:"sm",variant:"new"===u?"default":"outline",onClick:()=>h("new"),className:"new"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:"Nuevos (30 días)"}),(0,s.jsx)(i.Button,{size:"sm",variant:"active-orders"===u?"default":"outline",onClick:()=>h("active-orders"),className:"active-orders"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:"Con órdenes activas"}),(0,s.jsx)(i.Button,{size:"sm",variant:"inactive"===u?"default":"outline",onClick:()=>h("inactive"),className:"inactive"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:"Inactivos"}),(0,s.jsx)(i.Button,{size:"sm",variant:"multi-equipment"===u?"default":"outline",onClick:()=>h("multi-equipment"),className:"multi-equipment"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:"Múltiples equipos"}),(0,s.jsx)(i.Button,{size:"sm",variant:"recurring"===u?"default":"outline",onClick:()=>h("recurring"),className:"recurring"===u?"bg-violet-600 hover:bg-violet-500 border-0":"bg-slate-800/50 border-slate-700/50 text-slate-300 hover:bg-slate-800 hover:text-slate-100",children:"Recurrentes"})]}),(0,s.jsx)(o.Card,{className:"bg-slate-900/50 border-slate-800/50 backdrop-blur-sm overflow-hidden",children:(0,s.jsxs)(C.Table,{children:[(0,s.jsx)(C.TableHeader,{children:(0,s.jsxs)(C.TableRow,{className:"border-slate-800/50 hover:bg-slate-800/30",children:[(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Nombre completo"}),(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Teléfono"}),(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Correo"}),(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Fecha de registro"}),(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Nº de equipos"}),(0,s.jsx)(C.TableHead,{className:"text-slate-400 font-semibold",children:"Acciones"})]})}),(0,s.jsx)(C.TableBody,{children:0===g.length?(0,s.jsx)(C.TableRow,{className:"border-slate-800/50",children:(0,s.jsxs)(C.TableCell,{colSpan:6,className:"text-center text-slate-400 py-12",children:[(0,s.jsx)(ex.Users,{className:"h-12 w-12 mx-auto mb-3 text-slate-600"}),(0,s.jsx)("p",{className:"text-sm font-medium",children:"No se encontraron clientes"}),(0,s.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Intenta ajustar los filtros de búsqueda"})]})}):g.map((e,t)=>(0,s.jsxs)(C.TableRow,{className:`border-slate-800/30 hover:bg-slate-800/40 transition-all duration-200 text-slate-300 ${t%2==0?"bg-slate-900/20":"bg-slate-900/40"}`,children:[(0,s.jsx)(C.TableCell,{className:"font-medium text-slate-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.nombre,e.es_recurrente&&(0,s.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-500/10 text-blue-400 border border-blue-500/20",children:(0,s.jsx)(eh,{className:"h-3 w-3"})})]})}),(0,s.jsx)(C.TableCell,{className:"text-slate-300",children:e.telefono}),(0,s.jsx)(C.TableCell,{className:"text-slate-400",children:e.correo}),(0,s.jsx)(C.TableCell,{className:"text-slate-400",children:e.fecha_registro}),(0,s.jsx)(C.TableCell,{children:(0,s.jsxs)(ei,{open:p===e.id,onOpenChange:s=>v(s?e.id:null),children:[(0,s.jsx)(en,{asChild:!0,children:(0,s.jsxs)(i.Button,{variant:"ghost",size:"sm",className:"text-violet-400 hover:text-violet-300 hover:bg-violet-500/10 gap-1.5 transition-all",children:[(0,s.jsx)(ev.Package,{className:"h-3.5 w-3.5"}),e.num_equipos]})}),(0,s.jsxs)(ec,{className:"bg-slate-900 border-slate-700/50 text-slate-100 w-[420px] p-0 shadow-xl shadow-black/50",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-800/50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-semibold text-base text-slate-100",children:"Equipos del cliente"}),(0,s.jsxs)("span",{className:"text-xs text-slate-500 bg-slate-800/50 px-2 py-1 rounded",children:[e.equipos.length," ",1===e.equipos.length?"equipo":"equipos"]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:e.nombre})]}),(0,s.jsx)("div",{className:"max-h-[320px] overflow-y-auto p-3 space-y-2",children:e.equipos.map(e=>(0,s.jsxs)("div",{className:"p-3 rounded-lg bg-slate-800/40 border border-slate-700/50 hover:border-violet-500/40 hover:bg-slate-800/60 transition-all group",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"text-sm font-semibold text-slate-100 mb-0.5",children:[e.marca," ",e.modelo]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Marca:"})," ",e.marca]}),(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Modelo:"})," ",e.modelo]}),(0,s.jsxs)("p",{className:"text-xs text-slate-400",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"Serie:"})," ",e.serie]})]})]}),(0,s.jsxs)("span",{className:"text-xs text-slate-500 font-mono bg-slate-900/50 px-2 py-1 rounded",children:["#",e.id]})]}),(0,s.jsxs)(i.Button,{size:"sm",variant:"ghost",className:"w-full text-xs text-indigo-400 hover:text-indigo-300 hover:bg-indigo-500/10 border border-transparent hover:border-indigo-500/20 transition-all mt-2",onClick:()=>{console.log("[v0] Ver equipo:",e.id)},children:[(0,s.jsx)(eg.Eye,{className:"h-3.5 w-3.5 mr-1.5"}),"Ver equipo"]})]},e.id))}),(0,s.jsx)("div",{className:"p-3 border-t border-slate-800/50 bg-slate-900/50",children:(0,s.jsxs)(i.Button,{size:"sm",className:"w-full bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-500 hover:to-indigo-500 text-white shadow-lg shadow-violet-500/20 hover:shadow-violet-500/30 transition-all",onClick:()=>{console.log("[v0] Agregar nuevo equipo para cliente:",e.id),v(null)},children:[(0,s.jsx)(em.Plus,{className:"h-4 w-4 mr-2"}),"Agregar nuevo equipo"]})})]})]})}),(0,s.jsx)(C.TableCell,{children:(0,s.jsx)(i.Button,{size:"sm",variant:"ghost",className:"text-indigo-400 hover:text-indigo-300 hover:bg-indigo-500/10 transition-all",children:"Detalles"})})]},e.id))})]})})]})}),(0,s.jsx)(w.Dialog,{open:m,onOpenChange:x,children:(0,s.jsxs)(w.DialogContent,{className:"bg-slate-900 border-slate-800 text-slate-100 max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)(w.DialogHeader,{children:(0,s.jsx)(w.DialogTitle,{className:"text-slate-100 text-xl",children:"Nuevo cliente"})}),(0,s.jsx)(N,{onClose:()=>x(!1)})]})})]})}e.s(["default",()=>ef],48363)}]);